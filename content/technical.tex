generator functions used, maps for fast access